import './style.css'
import '@mdi/font/css/materialdesignicons.css'
import OpenAI from 'openai'
import { marked } from 'marked'

// Initialize OpenAI client
const openai = new OpenAI({
  apiKey: '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', // Replace with your actual API key
  dangerouslyAllowBrowser: true
})

// DOM Elements
const chatContainer = document.getElementById('chatContainer')
const messageInput = document.getElementById('messageInput')
const sendButton = document.getElementById('sendButton')

// Conversation history with system message
let messages = [
  {
    role: 'system',
    content: `You are Ai assistant to Fabrication connected Software,
    follow the following Instruction
    1- I will provide with documentation about the software use it to answer the user questions.
    2-don not answer general questions and respond politely to the user.
    `
  },
    {
    role: 'system',
    content: `the FabricationConnected documentation
    Fabrication tools is an Autodesk Revit plugin created by Allied BIM.\nAllied BIM vision: Connecting design model data to fabrication machinery to reduce carbon footprint by reducing overall project waste, increasing the safety of machine operators, and enhancing the throughput of machinery.\nMission: Allied BIM is connected to machine manufacturers around the globe and partnered with Autodesk Construction Solutions to enable the world’s best-in-class cloud model-to-machine workflows on the market. The Alliance enables a process for publishing, tracking, and communicating fabrication shop workflows from anywhere in the world.\nValues: Seamless Model-Machine Integration for Enhanced Performance. Harness Intelligent Insights for Optimal Fabrication Shop Efficiency. Maximize Material Utilization and Savings through Smart Material Optimization. Elevate Labor Productivity with Safety-Centric Intelligent Insights.\nhttps://alliedbim.com/\nsupport@alliedbim.com\n208-906-3659\nFabrication Tools for Revit is here to make the BIM process easier for contractors, especially if you're new to it. It helps you share information between your 3D models and the job site, saving time and cutting costs.\nProblem Definition:\nContractors encountered the following challenges before using Fabrication Tools for Revit:\n\nInfo Confusion: Difficulty in coordinating information between 3D models and the job site, resulting in confusion and errors, leading to project delays.\nCost Hikes: Inefficient management of assemblies and materials, leading to higher project costs.\nNew Process Hassle: Adapting to the new Building Information Modeling (BIM) process was challenging because existing tools did not provide adequate support.\n\nFabrication Tools for Revit solves these problems by providing easy-to-use tools for managing assemblies, spooling, and materials. This makes Building Information Modeling (BIM) accessible and efficient for all contractors.\n\nFabrication Tools Key Feature\nFabrication Tools for Revit makes working with BIM (Building Information Modeling) easier and ensures that your assemblies are free from errors. It also helps you prepare designs for prefabrication or on-site fabrication using TigerStop machines. Here's a breakdown of what it offers:\n\nEasy Assembly: You can create assemblies from your models in Revit without a hassle. These assemblies can be organized with names and numbers, making them easy to find using the Assembly Manager.\nAutomatic Tagging: With our tools, you can automatically tag your parts or rearrange them, saving you time.\nImport/Export Tools: You can quickly import and export your view templates, viewports, or legends using the export and import tools. This makes managing your project's views more convenient.\nManage Hangers: Our tools allow you to easily place hangers on selected fabrication parts based on your customized settings, making the process smoother.\nPoint Layout Features: We provide tools for creating, modifying, and reporting field control and layout information, making it easier to work in the field.\nFabrication Manager: We offer tools to optimize spooling, packaging, and ordering operations, ensuring a more efficient workflow.\nEffortless Spooling: You can batch-select assemblies and generate spools from your selections. This process is made smoother by using saved assembly settings.\nDirect Machine Export: You can export fabrication data directly to various machine manufacturers, reducing errors and saving time.\nMachine Integration: Effortlessly apply settings for machines like TigerStop, RazorGage, and Crippa directly to assemblies within the Assembly Manager. This simplifies the export process and reduces inefficiencies.\nEfficient Material Ordering: You can order bills of material directly within the plugin, reducing errors and streamlining your project workflow.\n\n\nIn a nutshell, Fabrication Tools for Revit simplifies the BIM process, making it error-free and efficient for contractors. It's a valuable tool for those working with Revit and looking to streamline their assembly and fabrication processes.\n\n\n\nthe plugin have a Revit tab with name \"[N] FabricationConnected\"\nunder this tab there are a punch of panels, in each panel there is a group of tools.\n[Assembly Tools] Panel:With our assembly tools, you can effortlessly create assemblies and even combine multiple assemblies. We provide support for managing groups, allowing you to efficiently handle your group configurations. Additionally, our packages features enable you to package items from various sources and effortlessly perform unpackaging when needed. This integrated toolset simplifies your project workflow, making project management more efficient and organized.\n\n[Create Assembly] Button: Description \nThis feature enables you to generate an assembly from elements you select within the drawing area. Using the \"Create Assembly\" function, you can merge chosen elements in the drawing area into a single entity. This assembly can be further scheduled, tagged, and isolated to create assembly views and sheets, making it a powerful tool for organizing and presenting your project.\nWhy Use the Create Assembly Feature?\nThe Create Assembly feature offers a solution for efficiently managing complex groups of elements. Assemblies enable you to group related elements, such as window assemblies or door assemblies, streamlining the process of creation, modification, and management.\nStep-by-Step Guide:\nClick \"Create Assembly\": Click on the \"Create Assembly\" icon.\nSelect Elements: Begin by highlighting or selecting the elements in your project that you want to include in the assembly.\nEnter Assembly Information:\nPrefix: Enter the assembly's name prefix.\nNum: Specify the assembly number.\nName: Provide a name for the assembly.\nSuffix: Add an assembly name suffix.\nPreview: Here, you can see a preview of the full assembly name.\nAssembly Views: Check this box to create views based on assembly settings. Select from the available assembly views and create construction views using your saved spool settings.\nUnique Assemblies Workaround): Choose this option if you want to create a unique assemblies workaround.\nCreate Button: Once you've named your assembly and configured the settings, click the \"Create\" button to complete the assembly creation process.\n\nOnce the assembly is created, you'll notice that when you hover over any part of the assembly, all connected components will turn blue. This blue color indicates that these parts are now part of the assembly.\n\n[Create Assembly Part-to-Part] Button:Description\nThe Create Assembly Part-to-Part feature enables you to construct a distinct assembly between specific paths with precision. By specifying the start and endpoint, this feature generates an assembly in the exact order you define within your fabrication system.\nWhy Use the Create Part-to-Part Assembly Feature?\nPart-to-part assembly is the process of joining two or more parts together to form a subassembly or the final product. It plays a crucial role in the manufacturing processes of various industries. Part-to-part assembly offers several key advantages, including:\n\nImproved Efficiency: Streamlining the connection of parts enhances production efficiency.\nEnhanced Accuracy: It ensures precise alignment, reducing errors.\nEnhanced Quality: The result is a higher-quality product.\nStep-by-Step Guide\n\n\nAccess the Tool: In the assembly tools section, click on the \"Create Assembly part-to-part\" icon.\nSelect Start Point: Click on the first part where you want to begin the connection.\nSelect End Point: Click on the end part where you want to finalize the connection.\nEnter Assembly Information:\nPrefix: Enter the assembly's name prefix.\nNum: Specify the assembly number.\nName: Provide a name for the assembly.\nSuffix: Add an assembly name suffix.\nPreview: See a preview of the full assembly name.\nAssembly Views: Check this box to create views based on assembly settings. ans select from the available assembly views.this will enable you to create construction views using your saved spool settings.\nUnique Assemblies Workaround: Opt for this option if you want to create unique assemblies.\nCreate Assembly: After naming your part-to-part assembly and configuring the settings, click the \"Create\" button to complete the assembly creation process.\n\nFollowing these steps, you'll notice that a connected path now exists between the start and end points, forming a unified path that is part of a single assembly.\n\n[Combine Assemblies] Button:Description \nThe \"Combine Assemblies\" feature empowers you to create one assembly from multiple assemblies. It's used to merge several assemblies into a single, unified assembly.  It's important to note that Revit itself cannot perform this function, as it lacks the capability to merge multiple assemblies together. This feature provides a practical solution for combining assemblies in your project.\nWhy Use the Combine Assemblies Feature?\nSimplify Workflow: Merging assemblies reduces steps, streamlining your work processes.\nAlignment and Clarity: It aligns components, enhancing communication and visual clarity.\nEfficiency Boost: When working on BIM projects, this feature significantly improves efficiency.\nStep-by-Step Guide\nIn the assembly tools section, click on the \"Combine Assembly\" icon.\nBegin selecting the assemblies you want to combine.\nAfter you've finished selecting, click the \"Finish\" button.\nChoose your preferred setting view and click Finish.\nAfter completing these steps, you'll observe that the previously separate assemblies have merged into a single assembly. When you hover over any part of this assembly, they will turn blue, indicating their successful combination.\n\n[Disassemble and Group] Button:Description\nWith our \"Disassemble and Group\" feature, you can easily convert your assembly into a group. This tool streamlines the transformation process – just a single button click is all it takes.  the assembly name automatically becomes the group name, ensuring a seamless transition. This functionality is especially valuable as Revit does not directly support this feature, making it an essential tool for efficient workflow management.\n\nWhy Use the Disassemble and Group Feature?\n\nRevit does not support the direct conversion from an assembly to a group. If you attempt to group an existing assembly, you'll encounter an error message. The error message states, \"The elements may already be grouped or may be element types which are not allowed for grouping.\" This limitation prevents the direct conversion.\nStep-by-Step Guide\nSelect Assemblies: Highlight and multi-select the assemblies in the Revit Viewer that you wish to convert into groups.\nClick Disassemble and Group Icon: Click on the \"Disassemble and Group\" icon.\n\n[Ungroup and Assemble] Button: Description \nWith our \"Ungroup and Assemble\" feature, you can seamlessly convert a group into an assembly. This function ungroups the selected group from the Revit viewer and generates a new fabrication assembly. The key benefit is that the name of the group automatically becomes the name of the assembly. This tool simplifies the process of transitioning from a group to an assembly, particularly since Revit doesn't natively support this transformation.\nWhy Use the \"Ungroup and Assemble\" Feature?\n\n\nRevit doesn't provide a direct method to convert a group into an assembly in a single step. Instead, the process typically involves manual ungrouping and then creating an assembly. However, with the \"Ungroup and Assemble\" feature, you can seamlessly achieve this transformation. This function ungroups the selected group from the Revit viewer and creates a new fabrication assembly, simplifying the conversion process.\nStep-by-Step Guide\n\n\nSelect Groups: Highlight and multi-select the groups in the Revit Viewer that you want to transform into assemblies.\nClick \"Ungroup and Assemble\" Icon: Click on the \"Ungroup and Assemble\" icon.\nConversion Process: The conversion will be executed, and your assembly is now ready, named the same as the original group.\n\n[Racking Assembly Setting] Button: Description\n\nThe Racking Assembly Setting feature empowers you to add, edit, and store settings for the racking assembler tool. This functionality allows you to configure settings to determine which clamp families will be automatically placed, if any, streamlining your racking assembly processes.\nStep-by-Step Guide\n\n\nAccess the Tool: Click on the \"Racking Assembly Setting\" icon in the Assembly section.\nIf this is your first time adding a setting, you'll encounter an empty view with the only option being to add a new rule.\n\nAdd Rule: Click on the \"Add\" button (A) to create a rule for the trade size value , After clicking ,another window will be open where you can add your rules\n\n\n\n\n\nAdd Rule: Click on the \"Add Rule\" button to create a rule for the trade size value.\nConduits Type: Use the dropdown button to choose from available conduit types.\nClamp Family & Type: These two dropdown menus enable you to select from various clamp families and types. You can also load from .rfa files if needed.\nView the Clamp: This area displays the 3D shape of the clamp, providing a visual understanding of the component.\nSave Setting: Click the \"Save Setting\" button to save the rule setting and add it to your configuration\n\nAfter Adding your Rule , you will be pushed back to the setting screen , where it contains: \n\nList of Rules Added (1): This view displays a list of the saved rules.\nUp/Down Buttons (2): These buttons allow you to reorder the rules as needed.\nEdit Button (3): When you select a rule, the \"Edit\" button becomes active. Click on it to modify the rule according to your preferences.\nDelete Button (4): If you wish to delete a rule, select it, and you'll notice that the \"Delete\" button becomes active. Once deleted, the action cannot be undone.\nSave Button (5): When you're finished, click the \"Save\" button to confirm your rule settings, once saved the sava button will become inactive, indicating that all settings are saved.\n\n[Racking Assembler] Button: Description\nThe Racking Assembler feature is designed for creating assemblies with sorted items. Additionally, if selected, it has the capability to automatically place clamps. It's important to note that the configuration for the automatic placement of clamps can be customized in the Racking Assembly Settings.\nStep-by-Step Guide\n\nAccess the Tool: Click on the \"Racking Assembler\" icon” and  Fill Assembly Information:\nPrefix: Insert the prefix name for your assembly.\nNum: Provide the assembly number.\nName: Enter the name of your assembly.\nSuffix: Add a name suffix for your assembly.\nPreview: Use this option to preview the full name of the assembly.\nAssembly Setting: Modify the assembly setting, which includes creating a view for the setting. You can select from a dropdown menu.\nUnique Assemblies Workaround: Check this box if you want to create a unique assemblies workaround.\nClick Create: once you are done adding assembly information click Create.\n\nSelecting Parts: After completing your assembly information, you will be prompted to select the parts you want. Each selected part will be highlighted in blue.\nWhen you are done selecting, click on the \"Finish\" button.\nIf you wish to cancel, click on \"Cancel\". \n\n[Spool Settings] Button: Description \nThe Spool Setting feature allows you to modify and store spool settings for any spool within the context. This functionality empowers you to customize and save specific spool configurations to suit your project requirements.\n\nStep-by-Step Guide\nWhen you click on the spool setting icon, you gain control over your spool settings. The control panel consists of the following sections:\n\nSettings: In this section, you'll find a list of all the saved settings in your program. Here, you have a range of options, including:\nCreating new settings or duplicating existing ones.\nRenaming settings.\nRemoving settings.\nExporting settings.\nImporting settings.\nChecking for errors in settings, particularly in cases of missing data.\n\nSpool Information:This section contains essential spool-related details, such as the prefix, name, number, and suffix.\n\nViews Selection:  In this section, you can:\nChoose from a list of views that you want to use when creating your sheets by Simply check the boxes next to the views you require to add them to sheets.\nSelect template views for them and choose the scale of the selected view before adding them to a specific sheet.\n\nSheets:This section contains the sheets that are available for preview based on the selected views in section (3). Here, you can add or delete sheets, and even incorporate QR codes onto a sheet.\n\nViewport Title Overrides: Use this section if you want to override viewport titles, including type, anchor, and tags.\n\n\nOnce you've configured your settings,  click \"Save\" and all the settings will be safely stored.\n\n[Annotation Tools] Panel:Annotation Tools are like handy helpers for creating fabrication drawings. They save you time by doing the boring stuff for you, such as organizing, tagging, adding colors, making QR codes, and more\n\n[Automatic Tags] Button:Description\nThe Automatic Tag feature empowers you to add labels to your assembly in a 3D Ortho View. You have the flexibility to choose the order in which these tags are displayed, whether numerically, alphabetically, or based on your preferred order family. This feature enhances the clarity and organization of your assemblies, making it easier to communicate and manage project components.\nStep-by-Step Guide\n\n\nClick on the Automatic Tags icon,  this icon opens a new window, enabling you to configure your automatic tag settings. Within this window, you'll find the following options:\n\nGeneral Tag Settings: : Access general tag settings to further customize tagging. Detailed information can be found in the next section.\nSelect Elements : Choose the elements you want to tag and select the tags associated with them.\nDefine Order : Specify the ordering, whether it's numerical, alphabetical, or even load a family file.\nCustomize Tags : Choose whether to remove the headers associated with tags or override any existing values.\nStart Tagging : Click the \"Run\" button to begin the automatic tagging process.\n\n[Automatic Reordering] Button:Description\nThe Automatic Reordering feature enables you to renumber automatic tags if they are out of sequence. To use this function, tag the first and last part, and all the parts in between will be automatically tagged in the same numerical sequence. This feature simplifies the process of ensuring that your tags remain in the correct order, enhancing project organization and clarity.\n\nStep-by-Step Guide\n\nClick on the \"Automatic Reordering\" Icon: This will open the \"Reorder Tags\" tab for you.\nSpecify the Starting Value (2): Define the tag value that will be the first tag in the sequence.\nSpecify Categories to Tag (3): Choose the value you want to tag from the dropdown menu, specifying the categories.\nSpecify Tag Symbol (4): Determine the tag symbol to be used.\nSpecify Your Tagging Preference:\nSelect One Element (Tag All): Pick the first element in the sequence and auto-tag the remaining assembly.\nSelect Two Elements (Tag In Between): Select two elements to tag between them.\nIn the View, Select Elements to Start From: Choose the element to tag using one of the options above and end the command.\nClose Window When You Finish: When you done reordering , click the close window button \n\n[Manual Reorder] Button: Description \n\nThe Manual Reorder feature empowers you to arrange the spool sheet assembly in your desired sequence. You can select each element in the order you prefer, granting you full control over the assembly's arrangement. This feature lets you reorder tags for elements within an assembly in a 3D ortho view, based on stored tag settings and parameter information.\n\nStep-by-Step Guide\n\nClick the Manual Reorder Icon to open the Manual Reorder options.\nInsert your preferred Start Value (1). This can be a number, a character, or a mix of both, depending on what you like.\nCheck the Next Value (2) that will be inserted the next time you reorder. It updates automatically with your next value.\nAfter you've made your choices, start tagging by clicking and selecting the values in your preferred order.\nWhen you're finished reordering, click the close button in the Manual Reorder window.\n\n[Align Tags] Button: Description\n\nThe Align Tags feature is a handy tool that automatically organizes and aligns tags to improve their visual appearance in your view. It ensures that your tags are neatly aligned and spaced, making your drawings more visually appealing and easier to understand.\n\nStep-by-Step Guide\n\nClick the \"Align Tags\" icon from the toolbar.\nHighlight and Select the Tags that you want to align in your view.\nChoose a Starting Point on the page where you want the alignment to begin.\nSelect the Endpoint where you want the tags to align.\n\n[Clear Tags] Button: Description\n\nThe Clear Tag feature allows you to swiftly delete all tags within the current 3D ortho view. It offers an efficient way to remove tags when needed, providing a clean slate in your view.\n\nStep-by-Step Guide\n\nClick the \"Clear Tags\" Icon in the annotation tools section.\nA confirmation warning will pop up, asking if you want to delete all tags in the current view.\nChoose \"Yes\" to delete all tags in the current view or \"No\" to cancel the operation.\n\n[Inline Dimensions] Button: Description \n\nThe Inline Dimensions feature allows you to automatically generate and display dimensions for assembly parts in a 2D plan view. These dimensions provide a clear representation of the sizes and relationships between components in your assembly, making it easier to understand the design and ensure accurate measurements. This feature streamlines the dimensioning process, enhancing the overall clarity and precision of your project's documentation.\n\nStep-by-Step Guide\n\nIn the annotation tools section, click on the \"Inline Dimension\" Icon.\nAutomatic dimensions will be inserted into your 2D plan view, providing a clear representation of the assembly parts' sizes and relationships.\n\n[QR] drop down menu: Description This section provides you with the tools to manage QR code settings, such as adding, repositioning, or removing QR codes. By scanning these QR codes with a mobile device, you can conveniently access the spool sheet associated with the assembly.\n\n[Add Sheet QR Code] sub-button:Description \nThis feature simplifies the process of attaching QR Codes to sheets. By scanning these QR codes with a mobile device, such as a phone or tablet, you can instantly access the associated spool sheet. This feature allows users to apply QR Codes, enabling others to conveniently scan the code and access the spool sheet on their mobile devices.\nStep-by-Step Guide\nClick on the QR Code Icon.\nSelect \"Add Sheet QR Code\" from the options.\nChoose whether you want to add the QR code to the current sheet or all sheets.\nClick \"Accept.\"\nThe QR code will be inserted into your sheet, and you can move it within your view by selecting it. Scanning this code with a mobile device will allow you to access the associated spool sheet.\n\n[Relocating QR Code in All Sheet] sub-button: Description\n\nThis feature allows you to move QR codes in all sheets based on the current sheet's QR code. This provides the flexibility to position QR codes conveniently across all sheets in your project.\n\nStep-by-Step Guide\n\nClick the QR Code Icon.\nSelect \"Relocate QR Codes in All Sheets.\"\nAll QR codes in all sheets will be automatically repositioned to match the location of the QR code on your current sheet.\n\n[Clear QR Code] sub-button: Describtion\n\nThe Clear QR Code feature allows you to remove all QR codes from either the current sheet or all sheets within your project. It provides a quick and efficient way to clear QR codes, making them ready for reinsertion using other QR code tools. This feature effectively resets the QR code placement in your project.\n\nStep-by-Step Guide\n\nClick on the QR Code Icon.\nSelect \"Clear QR Codes\" from the options.\nChoose whether you want to clear QR codes from the current sheet or from all sheets.\nClick \"Accept\" to confirm the clearing operation.\n\n[Colors] drop down menu: Describtion \n\nThe Color section serves as a central hub for managing all coloring settings in your project. Here, you can easily add, remove, or fine-tune color settings to meet your specific needs and preferences.\n\n\n[Colors Parts From To] sub-button: Description\n\nThis feature that enables you to change the colors of a set of parts in your assembly. By selecting the first and last parts, all the parts in between will be colored with your chosen color. This feature is useful for distinguishing sub-assemblies within your project.\n\nStep-by-Step Guide\n\nClick on the Colors Icon.\nSelect \"COLOR PARTS FROM TO\" from the options.\nChoose the start point of your assembly by clicking on it in the project view.\nSelect the end point of your assembly by clicking on it in the project view.\nChoose you preferred color from the color pattle (1) or define your custom color (2).\nClick \"OK.\"\n\n\n[Resets Parts Colors] sub-button: Description\n\nThis feature allows you to revert the color of parts to their original state, effectively undoing any color changes you've made as you can choose whether to apply this reset in the current view only or in all assembly views .\n\nStep-by-Step Guide\n\nClick the Colors Icon.\nSelect the \"Reset Parts Color\" button.\nDecide whether you want to reset the color in the current view only or in all assembly views.\nClick \"Reset.\"\n\n\n[Color Parts Settings] sub-button: Description\n\nThis feature allows you to control how parts and tags are colored. You can choose whether to color them together or separately. Additionally, it provides options to configure and clear color settings for your project. This feature gives you flexibility in managing the visual representation of parts and tags in your assembly.\n\nStep-by-Step Guide\n\nClick the Color Icons.\nSelect \"Parts Color Setting.\"\nChoose one of the available color parts settings:\nColor Objects And Tags: This option colors both the outline of objects and tags.\nColor Objects Only: This option colors the outline of objects only.\nColor Tags Only: This option colors the outline of tags only.\nClick \"Save Configuration\"\n\n\n[Manag Visibility Overrides] sub-button: Description\n\nAssemblies Visibility Overrides empower you to apply colors from filters, overridden graphics, or colors produced by the fabrication center to multiple views in an assembly. It enables you to apply or select visibility overrides in an assembly view, offering greater flexibility in color management.\n\nStep-by-Step Guide\n\nElements: Choose either \"assemblies,\" \"groups,\" or both.\nReference View Template: Pick a color reference from an existing view template in the project.\nFilters / Color Overrides: Filter and select the color overrides you want.\nViews: Select the view(s) to apply color settings.\nActive View: Apply color settings to the current view only.\nAssembly Views: Apply color settings to assembly views of that assembly.\nSelect Views: Apply color settings to multiple views throughout the project.\nApply Colors: Use this option when you want to apply the colors and settings you selected.\nReset Colors: Use this button to reset all colors overrides to multiple view at once.\n\n\n[Selective Reset] sub-button: Description\n\nThis tool resets the assembly group colors in the active view, allowing you to reset the colors of multiple assemblies in the current view. it can be used at any view with colored assemblies.\n\nStep-by-Step Guide\n\nClick the Colors Icon. and Select \"Selective Reset.\"\nChoose Assemblies or groups to reset colors.\nClick the \"Reset Colors in View\" button.\n\n\n[Reset Elements Colors] sub-button: Description\n\nReset Elements Colors in an active view will undo any color assignments for elements in assemblies or groups within the active view, restoring them to their default colors.\n\nStep-by-Step Guide\n\nClick on the colors icon then select \"Reset Elements Colors\" button\nYou will notice that all elements color in your view has been reseted .\n/\\/\\/\\/\\\n[Export Tools] Panel:The Export Tools within our plugin streamline machine control exports for cut lists and enhance communication with Fabrication Desktop. With a diverse array of options catering to different machines such as Crippa, RazorGage, TigerStop, and more, this feature ensures seamless integration with various fabrication processes.\n\nMoreover, our Export Tools simplify the export of essential documents like bills of material and fabrication reports, fostering efficient communication and coordination between the plugin and fabrication machines. This comprehensive suite of tools empowers users to optimize their workflow and enhance productivity in the fabrication process.\n\n[Export] drop down menu: Description\n\nThis section teaches you how to easily export reports containing information about your parts and elements using various methods. It explains how to generate and save reports with the data you need for documentation or analysis\n\n[B.O.M] sub-button: Description\n\nThe Export Bill of Material feature in our plugin simplifies the process of exporting Revit schedules, producing a comprehensive Bill Of Materials list that can be saved in either a single or multiple Excel files. This enhances the efficiency of managing and analyzing project components.\n\nStep-by-Step Guide\n\nClick the Export Icon, then choose \"B.O.M.\"\nA new window will open where you can enter your preferred file name for your Bill of Material.\nSelect your desired file location to save the file and specify whether you want it as a single document or multiple documents.\nChoose the schedule(s) you want to export.\nClick the export button to export and save to the location you specified.\nA new window will prompt you to open the file. Click \"Yes,\" and an Excel sheet similar to the one shown below will open.\n\n[Fabrication Reports] sub-button: Description \n\nThe Export Fabrication Report feature allows you to generate reports for all assemblies in your fabrication manager. It creates an Excel document report that includes information from all assembly spool sheets.\n\nStep-by-Step Guide\n\nHighlight and select the assemblies you want to include in the report from your view.\nClick on the \"Export\" icon and choose \"Fabrication Reports.\" This will open a new window.\nComplete all the necessary information (1), which will be inserted into the report cover sheet, these information includes.\nPre-Title\nName\nTitle\nQuote\nQuoter\nFooter\n\nSelect the colors for your report (2) to enhance your report style. Opt for different colors for each level, including:\nBase Color\nBase Highlight Color\nHighlight Color\nHeaders Color\nClick \"Export.\"\nA file explorer window will open, prompting you to choose where to save your file. Select a location and click \"OK.\"\nAfter the processing is complete, a new popup will appear asking if you want to open the file. Choose \"Yes\" if you wish to open it, or select \"No\" if not.\n\n[Export Job File] sub-button: Describtion\nMAJ Export Job File creates a job file for ductwork to input into a CNC machine. As you can export a fabrication job (.MAJ) from revit and open it in an autodesk fabrication product ,for example , you may want to export fabrication parts from revit to fabrication ESTmep for costing ,fabrication CADduct for manufacture , of fabrication CADmep for documenting aditional detail , such as tags , spools and reports \n\nStep-by-Step Guide\n\nHighlight your mechanical duct assemblies from your view.\nClick on \"Export,\" then choose \"Export Job File.\"\nA file explorer will open, prompting you to select where you want to save your .MAJ file.\nOnce done, a popup will appear, confirming that the file has been saved.\n\n[Machine Export] drop down menu: Description\nThis section provides instructions on how to export files to machines like RazorGage, Crippa, and others. \n[Crippa] sub-button: Description\n\nCrippa Export allows you to set settings for the Crippa machine so when the assembly is exported directly to the saw, all settings are applied.\n\nStep-by-Step Guide\n\nSelect a view containing assemblies with conduit elements and select the assembly you want.\nClick the \"Machine Export\" button and then select \"Crippa.\"\nA file explorer window will open, asking you to specify the save location. Choose the location and click \"Save.\"\nA pop-up will display the progress percentage. Once it's complete, you'll locate the file in the location you specified.\n\n[Dusty Robotics Export] sub-button: Description\n\nThe Dusty Robotics Exporter feature creates an AutoCAD file from Revit's floor plans, suitable for sending to the Dusty Robotics Robot for precise layout in construction projects. It's a part of the next-generation construction layout technology, aiding project teams in significantly reducing schedule delays and rework costs through precise, full-scale floor layout.\n\nStep-by-Step Guide\n\nFrom the \"Machine Export\" button, choose \"Dusty Robotics Export.\"\nSelect your preferred level (1) for Dusty Robot export.\nIdentify the viewpoint number (2) associated with the chosen level where points are located.\nPick your desired export file type, either .DWG or .CSV.\nClick the \"Export\" button to generate your file.\nA new file explorer window will appear, prompting you to specify where to save the file. Choose a location and click \"Save.\"\nA popup will inquire if you wish to open the file. Click \"Yes\" if you want to open it.\n\n\n[EstiFrame Export] sub-button: Description\n\nEstiFrame Export Settings allow users to configure settings for the EstiFrame machine. When exporting an assembly directly to the saw, these settings are applied for seamless operation with EstiFrame, a leading automated marking system.\n\nStep-by-Step Guide\n\nHighlight and select the assemblies you want to export from your view.\nChoose whether the selected elements are Assemblies or Groups (1).\nClick \"Export\" (2)\n\n\n[RazorGage Settings] sub-button: Description\n\nRazorGage Settings enable users to configure machine settings for the RazerGage. These settings are applied when exporting an assembly directly to the saw, ensuring all parameters and assembly details are properly configured for the machine.\n\nStep-by-Step Guide\n\nClick on the \"RazorGage Settings\" button from the Machine Export section.\nThe RazorGage settings window will open.\nChoose a specific profile (1) assigned to the project. You can add, remove, duplicate, or edit profiles, each storing different settings.\nSelect a specific sorting method (2) for the project from a list, such as volume.\nIn this row (4), you can manage your cutlist:\nAdd another cut list column.\nEdit the current cut list column.\nDelete a cut list column from the current list.\nMove parameters up or down in the list.\nClick \"Export\" (5) to apply these settings to the RazorGage export settings.\n\n\n[TigerStop Settings] sub-button: Description\n\nTigerStop Settings enable you to configure settings for the TigerStop machine. When exporting an assembly directly to the saw, these settings are applied to ensure that all parameters and assembly details are correctly configured for the machine's operation.\n\nStep-by-Step Guide\n\nFrom the \"Machine Export\" buttom on the \"TigerStop Settings\".\nSelect the profile (1) you want to use. You can add, delete, duplicate, or edit profiles.\nChoose the format for your export file, either TigerStop or CSV.\nDecide if you want to sort the file (3) by selecting from the available sorting options.\nSet the location for the XML file of the cut list link (4). Choose whether to export the cutlist to one file or create multiple files.\nManage your list of parameters (5) along with column names\nFrom this row (6) You can:\nAdd another cut list column.\nEdit the current cut list column.\nDelete a cut list column from the current list.\nMove parameters up or down in the list.\nConfigure labels for the parameters displayed on the exported file.\nClick \"Export\" (7) and choose the folder to save the exported file.\nA popup will inquire if you wish to open the file. Click \"Yes\" if you want to open it.\n\n\n[Watts Mueller Export] sub-button: Description \n\nWattsMueller Export enables you to configure settings for the WattsMueller machine. These settings are applied when exporting an assembly directly to the saw, ensuring all parameters and assembly details are correctly configured for the machine's operation.\n\nStep-by-Step Guide\n\nSelect a view that contains Assemblies with Pipe elements.\nClick on the \"Machine Export\" button and select \"Watts Mueller Exporter.\"\nA file export window will appear, allowing you to choose where to save the file. Select the format (.allied) and save the file in your preferred location.\n\n[Point Tools] Panel: In this section,  you'll discover a range of tools designed to create, modify, and report field control and layout points. Our selection of tools makes it easy to place control points or layout points on a floor plan. Additionally, these tools aid in the detection of floor openings and facilitate the placement of layout points on plan views. Explore the various functionalities to enhance your control and layout processes.\n\n[Layout / Control Point] Button: Description\n\nWith the Layout/Control Point tool, you can easily put control or layout points on a floor plan for better coordination in the field.\n\nStep-by-Step Guide\n\nClick on the \"Layout/Control Point\" button.\nChoose whether to place a layout point or a control point (1).\nSpecify the starting number for point placement (2).\nSpecify the description of points to be laid out (3).\nClick \"Place Point\" to start point placement (4).\nBegin placing the points on a floor plan in your desired locations.\n\n[Point Manager] Button: Description\n\nThe Point Manager tool lets you see and manage all points in your project. You can renumber, delete, or update points as needed. Open the Point Manager to access a list of all inserted points in the model, and perform actions like numbering, deleting, or exporting data.\n\nStep-by-Step Guide\n\nThis dropdown (1) spacifices from where should we get the points list:\nView Points: List all points in current view.\nGlobal Points: List  all points in the whole project.\nSelcetion Points: List only all selected points.\nThis list (2) represent the points available listed with its number , describtion, x , y and z.\nThis grid (3) action represnets severalactions to change and update current points in the project.\nAuto-Numbering : This feature enables you to Renumber your points from a starting point.\nSelect the points you want to auto re-number from the view.\nClick on the \"Auto-Numbering\" Icon\nType the formate you want to start from ,the formate must follow the rule that is ( String - Number) such as \" x - 101\", the next value will be \"x - 102\" , \"x - 103\" and so on.\n\nDelete: Delete spacific point you select.\n\nExport Grid Data : Export the grid data to an Excel spreadsheet.\n\nExport Points : Export the points to an Excel spreadsheet.\n\nUpdate From Excel : This feature allow you to import the points from an excel sheet. As you can change the Excel file and then update Revit point data from the Excel file.\n\nClick the \"OK\" button to Apply these settings.\n\n[Points Detection] Button: Describtion\n\nThe Point Detection tool identifies points from an imported point layout, focusing on finding intersections between pipes and slabs/roofs. It automatically places a Layout point family at these locations, aiding in the detection of floor openings and facilitating the placement of layout points on plan views.\n\nStep-by-Step Guide\n\nClick on the \"Point Detection\" button\nselect the levels you want to detect \nClick Detect button.\n/\\/\\/\\/\\\n[Modeling Tools] Panel: The Modeling Section in Fabrication Tools provides vital tools for handling hanger settings and placing hangers, as well as managing MEP (Mechanical, Electrical, Plumbing) with MEP Expand. With MEP Expand, you can streamline the conduit routing process in your project.\n\n\n[Hanger Settings] Button: Description\n\nThis feature allows you to adjust the settings for fabrication part hangers in a hassle-free manner. By opening the settings window, you can modify how fabrication part hangers are placed, tailoring them to the specific needs of each fabrication part service within your model. This ensures precise and efficient placement of hangers.\n\nStep-by-Step Guide\n\nClick on the \"Hanger Setting\" icon  in the Fabrication Tools menu.\nIf it's your first time configuring settings, you may encounter a pop-up message stating, \"This Revit file has no loaded Fabrication Services.\" Here, you have two options:\nClick \"Yes\" to load Fabrication Services if you want to proceed with the setup.\nClick \"No\" if you want to cancel and exit this step.\nWhen you choose \"Yes,\" a settings pop-up window will appear. In this window, you can customize your fabrication settings according to your project requirements.\n\nFabrication Settings:\n\nFabrication Configuration: Clicking this button opens a tab where you can configure your fabrication settings. This is where you can setup various aspects of your fabrication work.\nConnection Indicators: By selecting this button, you can access color settings that allow you to change connection colors\nTo change a specific color, click on the part you want to modify.\nA color palette pop-up will appear, letting you choose your preferred color from a selection of options.\n\nFabrication Configuration:  You have the option to select and load either \"Revit MEP Imperial Content V2.4\" or \"Revit MEP Metric Content V2.3\" based on your project's units.\nFabrication Profile: Pick your preferred fabrication profile that suits your project's needs.\nReload Configuration: Click \"Reload Configuration\" to update the settings. This is useful for adding unloaded services and additional parts.\nLoading Services or Parts: To load services or parts, click on the respective tab. You'll see a list of loaded and unloaded services.\nUnloaded Services: This section displays a list of all available unloaded services. To select them all, simply press \"Ctrl\" + \"A\" on your keyboard.\nLoaded Services: This column displays the services that are currently loaded into your project.\nAdd / Remove Buttons:\nAdd Button: To load a service, go to the unloaded service list, select the service(s) you want to load, and then click the \"Add\" button .\nRemove Button: If you want to unload a service, simply go to the loaded services list, select the service(s) you want to remove, and then click the \"Remove\" button .\nSave Setting: If you want to save your fabrication settings, click \"OK.\" If not, click \"Cancel\" to exit without saving.\n\nOnce you've loaded and configured your fabrication settings, you can proceed by clicking on the \"Hanger Setting\" icon  . This action will allow you to access and adjust your hanger settings within the Fabrication Tools in Revit .\n\nAvailable Services: Choose a service from your loaded services list. \nUnits Standered: Select the unit standard you prefer, whether it's imperial or metric.\nDistance from Start: Type the value you want for the distance the hanger should leave from the starting point. The unit will be based on your specified standard.\nAttach to Nearest Structure: Check this checkbox if you want the hanger to be attached to the nearest structural part.\nDistribution Method: Choose between specifying an interval distance or a specific number of hangers (Based on spacing or number of hangers per element). \nInterval Distance: If you select interval distance, you can type the distance at which a new hanger will be placed.\nNumber of Hangers: If you choose to specify the number of hangers, you can define the quantity you want to place, regardless of the distance between them.\nHanger Selection Menu: Select from various available hanger types within the menu.\nPreview: Use this feature to preview the hanger settings you've configured in a 3D view.\nSave: Click \"Save\" to save your settings. If not, click the close icon in the popup window to discard changes.\n\n\n[Place Hangers] Button: Description\n\nThis feature allows you to put hangers on selected fabrication parts, following your predefined settings. You can place fabrication part hangers onto chosen fabrication components, either based on specified spacing or by specifying the number of hangers per element. This simplifies the process of positioning hangers precisely where you need them in your project.\n\nStep-by-Step Guide\n\nClick Place Hanger Icon: Click on \"Place Hangers\" tool icon  in the toolbar, a hanger tools window will open, initially without any information.\nSelect Your Desired Part: Within the project view, choose the fabrication part you want to add hangers to.\nClick Finish Button: Once you've made your selection, click the \"Finish\" button.\nView Information: After clicking \"Finish,\" the hanger tools window will populate with information specific to the part you selected. This information will include details about the hanger placement on the chosen part.\n\nGeneral Information: This section provides you with essential information about the selected fabrication part, including details about its service category and units.\nPlacing Parameters: Here, you can review the hanger settings that you added or set before. These settings determine how the hangers will be placed on the selected fabrication part.\nEdit Setting:  If you wish to make changes to your hanger settings, click on \"Edit Settings.\" This allows you to adjust the placement parameters to suit your specific needs.\nPlace Hangers: To actually place the hangers on the selected fabrication part according to the configured settings, click on \"Place Hangers.\"\n\n\n[MEP Expand] Button: Description\n\nThis tool is designed to speed up the creation of MEP (Mechanical, Electrical, Plumbing) routing in your project. It's worth noting that the current options for this tool are specialized for conduit. With MEP Expand, you can simplify the process of routing conduit in your project, making it more efficient and less time-consuming. This tool provides you with various routing options, including Kick 90, Stub 90, Offset, 4 Point Saddle, and 3 Point Saddle, allowing you to choose the most suitable method for your project needs.\n\nKick 90 Option\n\n\"Kick 90\"  is a feature commonly used in the context of ductwork or piping systems within Revit. It represents a 90-degree elbow designed to connect two components that are positioned at a 90-degree angle to each other and are at different heights or elevations. This functionality serves the purpose of altering the direction of the duct or pipe while accommodating variations in elevation. \"Kick 90\" is particularly valuable when you encounter obstacles in your design or when your system layout necessitates simultaneous changes in both direction and elevation. In essence, it connects two parts that meet at a 90-degree angle and are not at the same height.\n\nStep-by-Step Guide\n\nAccess MEP Expand: Click on the \"MEP Expand\" icon in your toolbar.\nMEP Expand Window: Once you click the icon, the MEP Expand window will open, revealing the following options.\n\nMEP Expand Dropdown: From this MEP Expand Dropdown\" dropdown Select \"Kick 90\" choose the \"Kick 90\" option. This sets the tool to create a 90-degree bend.\nUndo Action Button: You can use the \"Undo Action\" button to reverse any connections that have been made between parts, whether by you or anyone else.\nReverse Direction: If you wish to change the start/end direction of your MEP routing, click on the \"Reverse Direction\" icon.\nSpecify Kick Angle: You can define the angle of the kick (bend) you want to create. You can choose from the dropdown options or enter a customized angle as needed.\nRefresh: Click the \"Refresh\" button to update your part with the latest settings.\n\n\nSelect Parts for \"Kick 90\" Application: After specifying your \"Kick 90\" setting, go to the project viewer and select the parts to which you want to apply these changes. This allows you to target and modify specific components with the chosen \"Kick 90\" settings.\n\nStub 90 Option \n\n\n\"Stub 90\" simplifies the process of generating 90-degree extensions for conduits in your project. This tool allows you to effortlessly create precise conduit extensions at a fixed length, ensuring accurate routing and efficient design. Whether you're working on electrical, plumbing, or HVAC systems, \"Stub 90\" simplifies the process, saving you time and enhancing your overall productivity in Revit. It is particularly useful when you need to connect parts that meet at a 90-degree angle.\n\nStep-by-Step Guide\n\nOpen MEP Expand: Open the \"MEP Expand\" tool. This will open a new pop-up window where you can control your settings.\n\nMEP Expand Dropdown: Within the pop-up, use the Dropdown (1) to select from various MEP options. Choose \"Stub 90\" for this particular task.\nUndo Action Button: You can use the \"Undo Action\" button (2) to undo any connections that have been made between parts, whether by you or anyone else.\nReverse Direction: If you wish to change the start/end direction of your MEP routing, click on the \"Reverse Direction\" icon (3).\nSpecify Stub Length: In the \"Length of Stub\" field, insert the desired length of the stub you want in your project. This determines the size of the 90-degree extension.\nRefresh Button: Click the \"Refresh\" button to update your part with the latest settings.\n\n\nNow, go to the project viewer and select the parts to which you want to apply the \"Stub 90\" changes. This allows you to target specific components for the 90-degree extensions.\n\nOffset \n\n\"Offset\" is a option that allows you to modify the position or elevation of components within your project. It is particularly valuable for accommodating architectural and structural constraints. This tool is used to connect two parts that have an offset between them, and you have the flexibility to specify the offset angle as needed. It's a crucial tool for ensuring precise alignment and routing in your design.\n\nOpen MEP Expand: Open the \"MEP Expand\" tool. This will open a new pop-up window where you can control your settings.\n\nMEP Expand Dropdown: Within the pop-up, use the Dropdown to select from various MEP options. Choose \"Offset\" for this particular task.\nUndo Action Button: You can use the \"Undo Action\" button to undo any connections that have been made between parts, whether by you or anyone else.\nReverse Direction: If you wish to change the start/end direction of your MEP routing, click on the \"Reverse Direction\" icon.\nSpecify Offset Angle: In the \"Length of Stub\" field, insert the desired angle of the of you want in your project.\nRefresh Button: Click the \"Refresh\" button to update your part with the latest settings.\n\nNow, go to the project viewer and select the parts to which you want to apply the \"Offset\" changes. \n\n4 Point Saddle option\n\nThe \"4 Point Saddle\" option in MEP Expand simplifies the creation of complex bends for conduit and piping. It's especially useful for routing around obstacles, maintaining alignment, and enhancing design efficiency in electrical and plumbing projects.\n\nStep-by-Step-Guide\n\nOpen MEP Expand: Open the \"MEP Expand\" tool. This will open a new pop-up window where you can control your settings.\n\nMEP Expand Dropdown: Within the pop-up, choose \"4 Point Saddle\" from the Dropdown menu.\nUndo Action Button: Utilize the \"Undo Action\" button to undo/reverse any connections made between parts.\nChoose Connection Type: Specify whether you want to insert into an already connected part or between two separate parts.\nSpecify Bend Angle: Define the desired bend angle in degrees for the 4 Point Saddle configuration.\nReverse Offset Distance: If you need to change the direction of your offset distance, use the \"Reverse Offset Distance\" option.\nInsert Offset Distance: Enter the offset distance value as needed.\nReverse Span Direction: If you wish to change the direction of your span distance, you can use the \"Reverse Span Direction\" option.\nInsert Span Distance: Type the span distance value you require.\nRefresh Button: Click the \"Refresh\" button to update your part with the latest settings.\n\nSelect Parts for \"4 Point Saddle\": Finally, navigate to the project viewer and select the parts you want to apply the \"4 Point Saddle\" changes to.\n\nNote: When you select a custom angle, you will notice a  icon at the end of the input box. This icon allows you to delete your custom angle and revert to selecting from the available angle choices in the dropdown menu.\n\n3 Point Saddle\n\nOpen MEP Expand: Open the \"MEP Expand\" tool. This will open a new pop-up window where you can control your settings.\nMEP Expand Dropdown: Within the pop-up, choose \"3 Point Saddle\" from the Dropdown menu.\nUndo Action Button: Utilize the \"Undo Action\" button to reverse or undo any connections that have been made between parts.\nChoose Connection Type: Specify whether you want to insert into an already connected part or between two separate parts.\nSpecify Outer Angle: Input the preferred outer angle as the outer angle defines the orientation of the saddle connection. .\nReverse Outer Angle: Click on the \"Reverse Outer Angle\" icon if you wish to reverse the outer angle direction. Reversing the outer angle may be necessary to align the saddle connection correctly, especially when dealing with complex part configurations\nInput Middle Angle: Type in the value for the middle angle. The middle angle determines the positioning of the saddle's central point. Accurate input ensures the connection aligns precisely with your project's requirements.\nReverse Offset Distance: Click on this icon to reverse the offset distance.  Reversing the offset distance is important for adjusting the position of the saddle connection and its offset from the connected parts.\nInput Offset Distance: Enter the offset distance value as needed, Setting the correct offset distance ensures that the saddle connection fits precisely within your project's layout\nRefresh Button: Click the \"Refresh\" button to update your part with the latest settings.\n\nSelect Parts for \"3 Point Saddle\": Finally, navigate to the project viewer and select the parts you want to apply the \"3 Point Saddle\" changes to.\n/\\/\\/\\/\\\n[Conduit Tools] Panel: Conduit Tools are crucial utilities crafted to simplify the management of couplings, duct placement, and settings in your Revit project. With our conduit tools, you can effortlessly add or align couplings, manage duct bank settings, and easily place or export duct banks. \n\n\n[Add Couplings] Button: Description\n\nThis feature enables you to seamlessly insert couplings into conduits where they intersect with a reference plane or model line. It ensures secure and precise connections, enhancing the integrity of your conduit layout. This tool simplifies the conduit design process.\n\nStep-by-Step Guide\n\nAccess \"Add Couplings\" Tool: Open the fabrication toolbar and click on the \"Add Couplings\" icon. A new window will open with the following options  \nGet References: First, select your reference from your project view. Then, click on the \"Get References\" button to load references from the project view. The selected references will appear as a list below the button.\nGet Conduits: First, select your conduit from the project view. Then, click on the \"Get Conduit\" button to load conduits from the project view. The selected conduits will appear as a list below the button.\nCoupling Settings: In this section, you can specify and choose the coupling type you want to place from the dropdown list. You can also indicate whether you want to flip the coupling direction by checking the checkbox.\nAdd Couplings: Click on the \"Add Couplings\" button to apply the coupling settings to your project, it will take a short time to process. You will then see that the couplings have been added to your selected conduits.\n\n\n[Align Couplings] Button: Description\n\nThe \"Align Couplings\" feature aligns couplings to selected couplings by their centroid. In other words, it ensures that couplings are positioned in a way that their centers or midpoints match, providing accurate and secure connections between conduits or pipes. This feature simplifies the alignment process and helps maintain consistency in your project.\n\nStep-by-Step Guide\n\nAccess \"Align Couplings\" Tool: From the toolbar, click on the \"Align Couplings\" icon.\nSelect the First Coupling: Choose the first coupling to which you want to align other couplings.\nSelect Couplings to Align: Select the coupling(s) that you want to align to the first selected coupling.\nClick \"Finish\": After selecting the couplings, click the \"Finish\" button. This action will align the selected couplings according to the first one.\n\n\n[Unsplit Conduit] Button: Description\n\nThe \"Un-Split Conduit\" feature allows you to unsplit a conduit at a selected coupling. In other words, it reverses the splitting of a conduit that was previously divided and restores it to a continuous state. This tool is useful when you want to join separate conduit sections into a single, unbroken conduit run, ensuring a more organized and efficient layout for your systems.\n\nStep-by-Step Guide\n\nAccess \"Un-Split Conduit\" Tool: From the toolbar, click on the \"Un-Split Conduit\" icon.\nSelect Conduit Couplings to Un-Split: In the project viewer, select the conduit couplings that you want to un-split.\nClick \"Finish\": After selecting the couplings, click the \"Finish\" button. This action will un-split the chosen conduit couplings.\n\n\n[Run And Elements] Button: Description \n\nThe \"Run And Elements\" feature in Revit lets you select a conduit run and its parts, including conduits and fittings. You can then apply project parameters to these elements, simplifying management. Note that conduit runs don't apply to Conduit with Fittings Type. This tool is designed for MEP professionals to enhance workflow efficiency.\n\nStep-by-Step Guide\n\nAccess \"Run And Elements\" Tool:  From the toolbar, click on the \"Run And Elements\" icon.\nSelect the Part: Choose the part that you want to select it's path and work with.\nClick \"Finish\": After selecting the part, click the \"Finish\" button to complete the process.\n\n\n[Run Elements Cleanup] Button: Description\n\nThe \"Run Elements Cleanup\" feature allows you to synchronize project parameters from conduit runs to the conduits and conduit fittings that make up the conduit run. It simplifies the process of ensuring that parameters are consistent and aligned across all components within a conduit system. It's important to note that conduit runs are not applicable to Conduit with Fittings Type. This feature is valuable for maintaining project parameter consistency and organization in your design.\n\nStep-by-Step Guide\nAccess \"Run Elements Cleanup\" Tool:  From the toolbar, click on \"Run Elements Cleanup.\"\n\nAfter accessing the tool, you will notice that the project parameters have been synchronized from conduit runs to the conduit and conduit fittings. The feature ensures consistency and organization of project parameters within your conduit system.\n\n\n[Duct Bank Settings] Button: Description\n\nModify/Set settings of the duct banks  this way also provides ways to  import and export settings \n\nPlace Duct Banks on selected fabrication parts based on settings. Place fabrication part hanger onto selected fabrication parts based on spacing or number of hangers per element.\n\nStep-by-Step Guide\n\nAccess \"Duct Bank Setting\": From the toolbar, click on the \"Duct Bank Setting\" icon.\nCustomize Duct Bank Settings: The Duct Bank Setting window will open, providing options to customize your settings. Here's what you can adjust:\nSetting's Profile: Choose from an existing setting profile in the dropdown or add a new one by clicking the  icon and entering a new setting profile name.\nUnit Standard: Specify the unit standard based on your project's needs, whether you prefer imperial or metric.\nHole Placement Settings: Customize hole placement with the following options:\nSpacing in Between: Set the uniform distance between each spacer plate.\nSpacing from End: Define the offset distance from the center point of the spacer to the nearest endpoint of the conduit.\nMax Vertical Separation: Enter the maximum vertical separation. If this distance is exceeded, conduits will be grouped separately.\nMax Horizontal Separation: Set the maximum horizontal separation. If exceeded, conduits will be grouped separately.\nSpacer Parameters: Edit and specify spacer parameters.with the following options:\nHorizontal Padding: Specify the horizontal padding value for the duct bank.\nVertical Padding: Specify the vertical padding value for the duct bank.\nCreate Concrete Flow Holes: Enable this option if you want to add concrete flow holes to your duct bank.\nRebar Hole Vertical Margin: Configure the vertical margin for rebar holes.\nRebar Hole Lateral Margin: Configure the lateral margin for rebar holes.\nSpacer Thickness: Specify the thickness of spacers.\nHole Diameter Tolerance: Set the tolerance for hole diameter.\nHole Diameter: Define the diameter of holes.\nRebar Hole Diameter: Specify the diameter of rebar holes.\nKey Slot Offset From Rebar: Set the key slot offset from rebar.\nPreview: Use this option to visualize your settings in a 3D model and observe real-time changes in the model. You can also manipulate the model to view it from various angles.\nManage Setting State: This section likely allows you to manage different states or versions of your duct bank settings.\nExport: Click on \"Export\" to save your current settings as a JSON file on your local device.\nImport: Use the \"Import\" button to import and apply a setting file from your local device.\nSave: Click the \"Save\" button to save your duct bank settings, ensuring that any changes you made are retained for your project.\n\n\n[Place Duct Bank] Button: Description \n\nThe \"Place Duct Bank\" feature allows you to position a duct bank on selected fabrication parts within your project, following specific settings. This involves placing fabrication part hangers onto chosen fabrication parts based on predefined spacing or the desired number of hangers per element. It simplifies the process of arranging duct banks according to your project requirements in a precise and efficient manner.\n\nStep-by-Step Guide\n\nAccess \"Place Duct Bank\" Tool: From the toolbar, click on \"Place Duct Bank\".\nSelect Parts: Choose the fabrication parts where you want to place the duct bank. Then, click \"Finish.\"\nCustomize Settings: A window will open with the following options:\nSetting: Select a setting profile from the dropdown, choosing from your saved settings.\nConserved Spacing: Choose whether you want the conserved spacing to be at the middle or end of the conduit.\nPlacing Option: Define your preferred placing option from these three choices:\nEntire Path: Distribute spacer plates evenly throughout the entire conduit's path.\nSegment: Distribute spacer plates along the designated segment of the conduit runs.\nSingle Spacer: Position a solitary spacer plate at a precise location on the designated segment of the conduit runs.\nCreate Duct Bank: After setting up your preferences, click the \"Create\" button to place the duct bank according to your chosen settings.\n\nPlace Duct Bank: Segment \n\nThis option allows you to distribute spacer plates along the designated segment of the conduit runs. This feature is particularly useful when you need to place spacer plates at specific intervals within a defined portion of your conduit system. It offers precise control over the placement of spacer plates to meet the requirements of your project design.\n\nPlace Duct Bank: Single Spacer \n\nThis option enables you to position a single spacer plate at a precise location on the designated segment of the conduit runs. This feature is valuable when you need to place a spacer plate at a specific point within your conduit system. It provides precise control over the placement of individual spacer plates to meet the exact requirements of your project design.\n\nPlace Duct Bank: Entire Path \n\nThis option allows you to evenly distribute spacer plates throughout the entire conduit's path. This feature simplifies the process of placing spacer plates along the full length of the conduit, ensuring that they are spaced at regular intervals. It provides a convenient way to achieve uniform spacing for spacer plates within your conduit system, streamlining your project design.\n\n\n[Export Duct Bank Plate] Button: Description\n\nThe \"Export Duct Bank Plate\" feature allows you to export your duct bank settings as DWG or DXF files. This is a useful function for saving and sharing your duct bank configurations in a format that can be easily accessed and utilized by other software applications or team members. It ensures that your duct bank design can be seamlessly integrated into your project workflow.\n\nStep-by-Step Guide\n\nAccess \"Export Duct Bank Plate\" Tool: From the toolbar, click on \"Export Duct Bank Plate.\"\nAccess Export Settings: A new window will open, and you'll find the following options:\nSearch Bar: You can search for available duct bank types by typing their names.\nAvailable Duct Bank Types: This lists all the duct bank types available in your project.\nExport File Option: Choose the file type you want to export, either DWG or DXF.\nExport Button: Click the \"Export\" button to initiate the export process.\nSpecify Export Location: When you click \"Export,\" a file explorer window will appear, prompting you to specify the location where you want to save the exported file. Choose the location and click \"Save.\"\n/\\/\\/\\/\\\n[Export/Import Tools] Panel: With our import and export tools, you can easily store and transfer View Templates, legends, or viewports between projects and Revit versions. This functionality eliminates the need for transferring project standards and enables the loading of View Templates, legends, or viewports from different Revit versions seamlessly.\n\n\n[View Template Export / Import] Buttons: Description\n\n\n\nExport View Template: Save a View Template as a separate file, enabling storage and transfer between projects and Revit versions.\nImport View Template: Easily load a previously saved View Template from a file, This feature eliminates the need for \"Transfer Project Standards\" and allows you to load View Templates from different Revit versions This streamlines the process of maintaining consistency and efficiency in project views.\n\nStep-by-Step Guide \n\nExport View Template \n\nAccess View Template Export: Click on the \"View Template Export\" icon .\nConfigure Export Settings: The \"View Template Export Setting\" window will open with the following options:\n\nFilter Based on Discipline and View Type: You can filter the available view templates based on discipline and view type.\nSearch Box: Use the search box to find a specific view template by name.\nView Templates List Available: These are the view templates available after applying your filters or conducting a search. Select a view template by clicking on it.\nExport View Template: After selecting the view template, click the \"Export\" button to initiate the export process.\nChoose Export Location: A new file explorer window will open, allowing you to specify the location where you want to save the exported file. Select the location and click \"Save.\"\nConfirmation Message: A message will appear, informing you that the View Template has been exported successfully.\nNow, you can find the saved file in the location you provided. \n\nImport View Template \n\nAccess View Template Import: Click on the \"View Template Import\" icon .\nLocate & Select Exported View Template File: A file explorer window will open, prompting you to select the previously exported View Template file. Choose the file and click \"Open.\"\nConfirmation Message: Once the file is loaded, a message will appear, informing you that the file has been successfully imported.\n\n\n[Viewport Type Export / Import] Buttons: Description\n\nExport Viewport: Save a viewport as a separate file, enabling storage and transfer between projects and Revit versions.\nImport Viewport: Easily load a previously saved viewport type from a file, removing the necessity for \"Transfer Project Standards\" and facilitating the use of viewport types across different Revit versions. This streamlines the process of maintaining consistency and efficiency in project views.\n\nStep-by-Step Guide \n\nExport Viewport Type\n\nAccess Viewport Type Export: Click on the \"Export Viewport Type\" icon .\nSelect Viewport to Export: The \"Viewport Type Export\" window will open with the following options:\nSearch Box: You can search for available viewport types by name.\nSelect Viewport Type to Export: Choose a viewport type to export from the list by clicking on it.\nExport Viewport Type: Click the \"Export\" button to start the export process.\nChoose Export Location: A file explorer window will open, allowing you to specify the location where you want to save the exported file. Select the location and click \"Save.\"\n\nImport Viewport Type\n\nAccess Viewport Type Import: Click on the \"Viewport Type Import\" icon  .\nLocate & Select Exported View Template File: A file explorer window will open, prompting you to select the previously exported Viewport file. Choose the file and click \"Open.\"\nConfirmation Message: Once the file is loaded, a message will appear, informing you that the file has been successfully imported.\n\n\n[Legend Export / Import] Buttons: Description\n\nExport Legend: Save a Lagend as a separate file, allowing you to store and transfer legends between different projects and Revit versions. This simplifies the process of maintaining consistency and reusing legends.\nImport Legend: Load a previously saved legend from a file, eliminating the requirement for \"Transfer Project Standards\" and enabling the use of legends across various Revit versions. This enhances the flexibility and efficiency of working with legends in your projects.\n\n\nStep-by-Step Guide \n\nLagend Export\n\nAccess Legand Export: Click on the \"Lagend  Export\" icon .\nSelect Viewport to Export: The \"Lagend Export\" window will open with the following options:\n\n\nSearch Box: You can search for available viewport types by name.\nSelect Lagend to Export: Choose a Lagend  to export from the list by clicking on it.\nExport Lagend : Click the \"Export\" button to start the export process.\nChoose Export Location: A file explorer window will open, allowing you to specify the location where you want to save the exported file. Select the location and click \"Save.\"\n  \nLagend Import\n\nAccess Lagend  Import: Click on the \"Lagend Import\" icon  .\nLocate & Select Exported Lagend File: A file explorer window will open, prompting you to select the previously exported Lagend zip file. Choose the file and click \"Open.\"\nConfirmation Message: Once the file is loaded, a message will appear, informing you that the file has been successfully imported.\n\n[Fabrication Manager] Panel: Description \n\nFabrication Manager is your go-to tool for making your work easier. It gathers all your spool data in one place. You can create spool sheets, bundle them together, and send them to your machines with ease.\n\n\nBut that's not all! It helps you organize your assemblies in your Revit project. You can quickly change sheet numbers and names on the spot. Plus, it can apply spool sheets in batches from the assembly settings database, making your work a breeze.\n\nShowing Fabrication Manager\n\nTo access the Fabrication Manager, follow these simple steps:\n\nLook & Click for the \"Show\" button in the toolbar located in the \"Fabrication Manager\" section.\nThat's it! You've now displayed the Fabrication Manager and are ready to use its powerful features.\n\nHiding Fabrication Manager\n\nTo hide the Fabrication Manager and clear it from your view, just follow these straightforward steps:\n\nLocate the \"Hide\" button, which is located in the plugin toolbar within \"Fabrication Manager\" section.\nClick on the \"Hide\" button.
    `
  },
 
]

// Function to add a message to the chat
function addMessage(content, isUser = false) {
  const messageDiv = document.createElement('div')
  messageDiv.className = `message ${isUser ? 'user' : 'ai'}`

  const avatar = document.createElement('div')
  avatar.className = 'avatar'
  avatar.textContent = isUser ? 'U' : 'AI'

  const contentDiv = document.createElement('div')
  contentDiv.className = 'content'
  
  // Use marked to parse markdown for AI responses
  if (!isUser) {
    contentDiv.innerHTML = marked.parse(content)
  } else {
    contentDiv.textContent = content
  }

  messageDiv.appendChild(avatar)
  messageDiv.appendChild(contentDiv)
  chatContainer.appendChild(messageDiv)
  chatContainer.scrollTop = chatContainer.scrollHeight
}

// Auto-resize textarea
messageInput.addEventListener('input', () => {
  messageInput.style.height = 'auto'
  messageInput.style.height = Math.min(messageInput.scrollHeight, 200) + 'px'
})

// Handle message sending
async function handleSend() {
  debugger;
  const message = messageInput.value.trim()
  if (!message) return

  // Add user message to chat and conversation history
  addMessage(message, true)
  messages.push({ role: 'user', content: message })
  
  messageInput.value = ''
  messageInput.style.height = 'auto'

  try {
    // Show loading state
    const loadingMessage = 'Thinking...'
    addMessage(loadingMessage)
    debugger;
    // Get response from OpenAI
    const completion = await openai.chat.completions.create({
      messages: messages, // Send full conversation history
      model: 'gpt-4o-mini',
      temperature: 0.7,
      max_tokens: 1000,
      top_p: 1,
      frequency_penalty: 0,
      presence_penalty: 0,
      stop: null,
      stream: false,
    })

    // Remove loading message
    chatContainer.removeChild(chatContainer.lastChild)
    
    // Add AI response to chat and conversation history
    debugger;
    const aiResponse = completion.choices[0].message.content
    messages.push({ role: 'assistant', content: aiResponse })
    addMessage(aiResponse)
    
  } catch (error) {
    console.error('Error:', error)
    chatContainer.removeChild(chatContainer.lastChild)
    addMessage('Sorry, there was an error processing your request.')
  }
}

// Send message on button click or Enter (without Shift)
sendButton.addEventListener('click', handleSend)
messageInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault()
    handleSend()
  }
})
